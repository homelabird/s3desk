## 요약
M8 보안/운영 표준화를 위한 정책/가이드/체크리스트를 확정하고 검증한다.

## 배경/문제
프로덕션 운영을 위한 키/토큰 정책, 백업/복구, 헬스체크 기준이 분산되어 있으며 실행 절차가 없다.

## 목표
- 키/토큰 회전 정책과 UX 확정
- 백업/복구 및 마이그레이션 롤백 절차 정리
- 운영 헬스체크/알람 기준 확정

## 범위
- 포함:
  - 키/토큰 회전 정책 및 UX 흐름
  - 비밀키 저장/암호화 정책 문서화
  - DB 백업/복구 절차 + 롤백 전략
  - healthz/readyz 분리 및 운영 알람 기준
  - 운영 Runbook/체크리스트 최신화
- 제외:
  - 원격/팀 권한 모델(RBAC)

## 수용 기준 (Acceptance Criteria)
- [x] 키/토큰 회전 정책과 UX 플로우 문서화
- [ ] DB 백업/복구 시나리오 1회 이상 리허설 성공
- [ ] 마이그레이션 롤백 전략 문서화
- [x] healthz/readyz 기준 문서화 및 체크리스트 반영
- [x] 운영 Runbook 최신화

## 리스크/가정
- SQLite/PG 백업 방식 차이로 절차 분기 필요

## 의존성
- 설정/배포 정책 확정

## 테스트/검증
- 백업/복구 리허설(로컬, 컨테이너)
- 토큰 회전 후 UI/CLI 재인증 시나리오

## 롤아웃/롤백
- 문서/플래그 기반 단계적 적용

## 메트릭
- 백업/복구 성공률
- 운영 체크리스트 수행률

## 토큰/암호화 정책 (초안)
- API_TOKEN
  - 회전 주기: 90일(운영 환경 기준)
  - 회전 방법: 서버 환경 변수/플래그 교체 → 서비스 재시작 → UI Settings의 X-Api-Token 업데이트
  - 영향: 기존 토큰은 즉시 무효, SSE/WS는 쿼리 토큰 재설정 필요
- ENCRYPTION_KEY
  - 형식: 32바이트 base64 (AES-GCM)
  - 회전 방법(보수적):
    1) DB 백업
    2) 기존 키 유지한 상태에서 프로필 비밀키 재확인(필요 시 내보내기)
    3) 새 ENCRYPTION_KEY로 재시작
    4) 프로필 저장/재등록으로 재암호화
  - 주의: 키 변경 시 기존 암호화 값 복호화 불가 → 복구는 백업과 기존 키가 필요

## Runbook
- 운영 Runbook은 `docs/RUNBOOK.md`에 분리하여 유지한다.

## 참고 링크
- docs/production-roadmap.md
- docs/OBSERVABILITY.md
